<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bandadas.net - Directorio de Comunidades de Aves</title>
    <style>
        :root {
            --green-50: #f0fdf4;
            --green-100: #dcfce7;
            --green-500: #22c55e;
            --green-600: #16a34a;
            --green-700: #15803d;
            --blue-50: #eff6ff;
            --blue-600: #2563eb;
            --blue-700: #1d4ed8;
            --blue-800: #1e40af;
            --yellow-300: #fde047;
            --yellow-400: #facc15;
            --yellow-500: #eab308;
            --orange-500: #f97316;
            --orange-600: #ea580c;
            --amber-50: #fffbeb;
            --amber-100: #fef3c7;
            --amber-200: #fde68a;
            --amber-500: #f59e0b;
            --amber-600: #d97706;
            --rose-600: #e11d48;
            --emerald-50: #ecfdf5;
            --emerald-600: #059669;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --white: #ffffff;
            --black: #000000;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --transition: all 0.3s cubic-bezier(0.165, 0.84, 0.44, 1);
            --border-radius: 0.75rem;
            --border-radius-lg: 1rem;
            --border-radius-xl: 1.25rem;
            --border-radius-2xl: 1.5rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background: linear-gradient(to bottom right, var(--green-50), var(--blue-50));
            color: var(--gray-900);
            line-height: 1.5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* NUEVO DISEÑO DE ENCABEZADO - MÁS FINO Y EN UNA SOLA LÍNEA */
        .header {
            background: linear-gradient(to right, var(--green-700), var(--blue-800));
            color: var(--white);
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 0;
            z-index: 50;
            height: 3.5rem; /* Altura reducida significativamente */
            display: flex;
            align-items: center;
        }

        .header-container {
            max-width: 80rem;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(4px);
            border-radius: 0.5rem;
            padding: 0.375rem;
            box-shadow: var(--shadow-md);
        }

        .logo-icon svg {
            width: 1.5rem;
            height: 1.5rem;
            stroke-width: 1.5;
        }

        .logo-text h1 {
            font-size: 1.25rem;
            font-weight: 700;
            white-space: nowrap;
            margin: 0;
            line-height: 1;
        }

        .logo-text p {
            display: none; /* Eliminado el subtítulo para ahorrar espacio */
        }

        .nav-buttons {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-btn {
            font-weight: 500;
            font-size: 0.875rem;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            transition: var(--transition);
            padding: 0.375rem 0.75rem;
            border-radius: 0.5rem;
            height: 2.25rem;
        }

        .nav-btn:hover {
            color: var(--yellow-300);
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-btn.active {
            color: var(--yellow-300);
            background: rgba(255, 255, 255, 0.15);
            font-weight: 600;
        }

        .add-btn {
            background: linear-gradient(to right, var(--yellow-400), var(--orange-500));
            color: var(--white);
            font-weight: 600;
            font-size: 0.875rem;
            padding: 0.375rem 1rem;
            border-radius: 0.5rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: none;
            cursor: pointer;
            height: 2.25rem;
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }

        .add-btn:hover {
            box-shadow: var(--shadow-md);
            opacity: 0.9;
        }

        .add-btn svg {
            width: 1rem;
            height: 1rem;
            stroke-width: 2;
        }

        /* Resto del diseño sin cambios significativos */
        .main-container {
            max-width: 80rem;
            margin: 0 auto;
            padding: 1.5rem;
            flex-grow: 1;
            width: 100%;
        }

        .hero {
            text-align: center;
            margin-bottom: 2.5rem;
        }

        .hero h1 {
            font-size: 2.25rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            background: linear-gradient(to right, var(--green-600), var(--blue-700));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            padding: 0 0.5rem;
        }

        .hero p {
            font-size: 1.125rem;
            color: var(--gray-700);
            max-width: 48rem;
            margin: 0 auto 1.5rem;
            padding: 0 0.5rem;
        }

        .promo-banner {
            max-width: 48rem;
            margin: 0 auto 2rem;
            padding: 1rem;
        }

        .promo-content {
            background: linear-gradient(to right, var(--amber-50), var(--amber-100));
            border: 1px solid var(--amber-200);
            border-radius: var(--border-radius-xl);
            padding: 1.25rem;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }

        .promo-content:hover {
            box-shadow: var(--shadow-md);
        }

        .promo-content-inner {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        @media (min-width: 640px) {
            .promo-content-inner {
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
            }
        }

        .promo-text {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .promo-icon {
            flex-shrink: 0;
            margin-top: 0.25rem;
        }

        .promo-icon svg {
            width: 1.5rem;
            height: 1.5rem;
            color: var(--amber-600);
            stroke-width: 2;
        }

        .promo-desc h3 {
            font-size: 1rem;
            font-weight: 500;
            color: var(--amber-900);
        }

        .promo-desc p {
            font-size: 0.875rem;
            color: var(--amber-800);
            margin-top: 0.25rem;
        }

        .promo-link {
            background: linear-gradient(to right, var(--amber-500), var(--orange-600));
            color: var(--white);
            font-weight: 700;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            text-decoration: none;
            display: inline-block;
            text-align: center;
            width: 100%;
        }

        @media (min-width: 640px) {
            .promo-link {
                width: auto;
            }
        }

        .promo-link:hover {
            box-shadow: var(--shadow-lg);
            opacity: 0.9;
        }

        .search-container {
            max-width: 48rem;
            margin: 0 auto 2rem;
            padding: 0 0.5rem;
        }

        .search-box {
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius-xl);
            font-size: 1rem;
            transition: var(--transition);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--green-500);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.2);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-400);
            width: 1.25rem;
            height: 1.25rem;
            stroke-width: 2;
        }

        .search-result {
            font-size: 0.875rem;
            color: var(--gray-600);
            margin-top: 0.5rem;
            text-align: center;
        }

        .search-result span {
            font-weight: 500;
            color: var(--green-600);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-900);
            margin: 1.5rem 0 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 0.5rem;
        }

        .section-title svg {
            width: 1.5rem;
            height: 1.5rem;
            margin-right: 0.5rem;
            stroke-width: 2;
        }

        .section-title.green svg {
            color: var(--green-600);
        }

        .section-title.blue svg {
            color: var(--blue-600);
        }

        .carousel {
            display: flex;
            overflow-x: auto;
            padding: 0.75rem 0.5rem;
            gap: 1rem;
            scrollbar-width: none;
            -ms-overflow-style: none;
            margin-bottom: 2rem;
            scroll-snap-type: x mandatory;
        }

        .carousel::-webkit-scrollbar {
            display: none;
        }

        .carousel-item {
            scroll-snap-align: start;
            flex-shrink: 0;
            width: 6rem;
        }

        @media (min-width: 640px) {
            .carousel-item {
                width: 7rem;
            }
        }

        .category-btn {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            border-radius: var(--border-radius-xl);
            transition: var(--transition);
            border: 1px solid transparent;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(4px);
        }

        .category-btn.active {
            background: linear-gradient(to bottom right, var(--green-500), var(--blue-600));
            color: var(--white);
            box-shadow: var(--shadow-md);
        }

        .category-btn:not(.active):hover {
            background: var(--white);
            border-color: var(--gray-200);
        }

        .category-img {
            width: 4rem;
            height: 4rem;
            border-radius: var(--border-radius);
            overflow: hidden;
            border: 2px solid var(--white);
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @media (min-width: 640px) {
            .category-img {
                width: 4.5rem;
                height: 4.5rem;
            }
        }

        .category-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .category-name {
            font-size: 0.75rem;
            font-weight: 500;
            text-align: center;
            min-height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 0.25rem;
        }

        @media (min-width: 640px) {
            .category-name {
                font-size: 0.875rem;
            }
        }

        .filters-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 2.5rem;
            padding: 0 0.5rem;
        }

        @media (min-width: 768px) {
            .filters-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        .filter-group label {
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
        }

        .filter-group svg {
            width: 1rem;
            height: 1rem;
            margin-right: 0.375rem;
            stroke-width: 2;
        }

        .filter-group.green svg {
            color: var(--green-600);
        }

        .filter-group.blue svg {
            color: var(--blue-600);
        }

        .filter-select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius-xl);
            font-size: 0.875rem;
            transition: var(--transition);
            background: var(--white);
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--green-500);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.2);
        }

        .results-info {
            text-align: center;
            margin-bottom: 2rem;
            padding: 0 0.5rem;
            font-size: 1.125rem;
            font-weight: 500;
            color: var(--gray-700);
        }

        .results-info span {
            font-weight: 700;
            color: var(--green-600);
        }

        .groups-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            padding: 0 0.5rem;
        }

        @media (min-width: 1024px) {
            .groups-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .group-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(4px);
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            transition: var(--transition);
            overflow: hidden;
        }

        .group-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .group-content {
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        @media (min-width: 768px) {
            .group-content {
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
            }
        }

        .group-info {
            display: flex;
            gap: 0.75rem;
        }

        .group-img {
            width: 4rem;
            height: 4rem;
            border-radius: var(--border-radius);
            overflow: hidden;
            flex-shrink: 0;
            border: 2px solid var(--white);
            box-shadow: var(--shadow-sm);
        }

        .group-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .group-details {
            min-width: 0;
            flex: 1;
        }

        .group-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 0.375rem;
            margin-bottom: 0.5rem;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 700;
            white-space: nowrap;
        }

        @media (min-width: 640px) {
            .badge {
                font-size: 0.875rem;
                padding: 0.375rem 0.75rem;
            }
        }

        .badge.platform {
            color: var(--white);
        }

        .badge.platform.telegram { background: #0088cc; }
        .badge.platform.whatsapp { background: #25D366; }
        .badge.platform.discord { background: #5865F2; }
        .badge.platform.signal { background: #3a76f0; }
        .badge.platform.viber { background: #7360f2; }

        .badge.members {
            color: var(--gray-500);
            font-weight: 500;
        }

        .badge.members svg {
            width: 0.875rem;
            height: 0.875rem;
            stroke-width: 2;
        }

        .badge.category {
            background: var(--green-100);
            color: var(--gray-500);
            font-weight: 500;
        }

        .badge.subcategory {
            background: var(--blue-100);
            color: var(--gray-500);
            font-weight: 500;
        }

        .badge.region {
            background: var(--amber-100);
            color: var(--gray-500);
            font-weight: 500;
        }

        .group-name {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.25rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .group-name-btn {
            background: none;
            border: none;
            color: var(--green-700);
            font-size: inherit;
            font-weight: inherit;
            text-align: left;
            cursor: pointer;
            width: 100%;
            text-decoration: none;
            padding: 0;
        }

        .group-name-btn:hover {
            color: var(--green-900);
            text-decoration: underline;
        }

        .group-desc {
            color: var(--gray-600);
            font-size: 0.875rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        @media (min-width: 640px) {
            .group-desc {
                font-size: 1rem;
            }
        }

        .group-btn {
            background: linear-gradient(to right, var(--green-500), var(--blue-600));
            color: var(--white);
            font-weight: 700;
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius-xl);
            border: none;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
            width: 100%;
            white-space: nowrap;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        @media (min-width: 768px) {
            .group-btn {
                width: auto;
                flex-shrink: 0;
            }
        }

        .group-btn:hover {
            opacity: 0.9;
            box-shadow: var(--shadow-lg);
        }

        .group-btn svg {
            width: 1.25rem;
            height: 1.25rem;
            stroke-width: 2;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1.5rem;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(4px);
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-md);
            border: 2px dashed var(--gray-300);
            max-width: 48rem;
            margin: 0 auto;
        }

        .empty-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .empty-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 0.5rem;
            padding: 0 1rem;
        }

        .empty-desc {
            color: var(--gray-600);
            max-width: 32rem;
            margin: 0 auto 1.5rem;
            font-size: 0.875rem;
        }

        @media (min-width: 640px) {
            .empty-desc {
                font-size: 1rem;
            }
        }

        .empty-btn {
            background: linear-gradient(to right, var(--green-500), var(--blue-600));
            color: var(--white);
            font-weight: 700;
            padding: 0.75rem 2rem;
            border-radius: var(--border-radius-xl);
            border: none;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-lg);
            font-size: 1rem;
        }

        .empty-btn:hover {
            opacity: 0.9;
            box-shadow: var(--shadow-xl);
        }

        .stats-section {
            margin-top: 3rem;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(4px);
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            text-align: center;
            border: 1px solid var(--gray-200);
            max-width: 64rem;
            margin-left: auto;
            margin-right: auto;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        @media (min-width: 640px) {
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 2rem;
            }
        }

        .stat-item {
            padding: 0.5rem;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        @media (min-width: 768px) {
            .stat-value {
                font-size: 2rem;
            }
        }

        .stat-value.green { color: var(--green-600); }
        .stat-value.blue { color: var(--blue-600); }
        .stat-value.yellow { color: var(--yellow-600); }
        .stat-value.rose { color: var(--rose-600); }

        .stat-label {
            font-size: 0.75rem;
            color: var(--gray-600);
        }

        @media (min-width: 640px) {
            .stat-label {
                font-size: 0.875rem;
            }
        }

        .association-promo {
            margin-top: 3rem;
            max-width: 56rem;
            margin-left: auto;
            margin-right: auto;
            background: linear-gradient(to right, var(--green-50), var(--emerald-50));
            border-radius: var(--border-radius-2xl);
            padding: 1.5rem;
            border: 1px solid var(--green-200);
            box-shadow: var(--shadow-sm);
        }

        .association-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 1rem;
        }

        @media (min-width: 640px) {
            .association-content {
                flex-direction: row;
                text-align: left;
                align-items: flex-start;
            }
        }

        .association-icon {
            width: 4rem;
            height: 4rem;
            border-radius: 9999px;
            background: linear-gradient(to right, var(--green-500), var(--emerald-600));
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .association-icon svg {
            width: 1.75rem;
            height: 1.75rem;
            stroke: var(--white);
            stroke-width: 2;
        }

        .association-text {
            flex: 1;
        }

        .association-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.5rem;
        }

        @media (min-width: 640px) {
            .association-title {
                font-size: 1.5rem;
            }
        }

        .association-desc {
            color: var(--gray-700);
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .association-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            align-items: center;
        }

        @media (min-width: 640px) {
            .association-buttons {
                flex-direction: row;
                align-items: center;
                gap: 1rem;
            }
        }

        .association-btn {
            background: linear-gradient(to right, var(--green-500), var(--emerald-600));
            color: var(--white);
            font-weight: 700;
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            text-decoration: none;
            display: inline-block;
            text-align: center;
            border: none;
            cursor: pointer;
        }

        .association-btn:hover {
            opacity: 0.9;
            box-shadow: var(--shadow-xl);
        }

        .association-link {
            color: var(--green-700);
            font-weight: 500;
            text-decoration: none;
            transition: var(--transition);
        }

        .association-link:hover {
            color: var(--green-900);
            text-decoration: underline;
        }

        .add-view {
            max-width: 48rem;
            margin: 0 auto;
            width: 100%;
            padding: 0 0.5rem;
        }

        .add-header {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
            gap: 0.75rem;
        }

        .back-btn {
            background: none;
            border: none;
            color: var(--gray-600);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2rem;
            height: 2rem;
            border-radius: 0.5rem;
        }

        .back-btn:hover {
            color: var(--green-600);
            background: var(--gray-100);
        }

        .back-btn svg {
            width: 1.25rem;
            height: 1.25rem;
            stroke-width: 2;
        }

        .add-title {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--gray-900);
        }

        .add-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(4px);
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--gray-200);
            overflow: hidden;
        }

        .add-header-bg {
            background: linear-gradient(to right, var(--green-500), var(--blue-600));
            padding: 1.25rem;
            text-align: center;
            color: var(--white);
        }

        .add-header-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .add-header-desc {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .add-form {
            padding: 1.25rem;
            display: grid;
            gap: 1rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        @media (min-width: 640px) {
            .form-row {
                grid-template-columns: 1fr 1fr;
            }
        }

        .form-group label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--gray-700);
            margin-bottom: 0.375rem;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--gray-300);
            border-radius: 0.75rem;
            font-size: 0.875rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--green-500);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.2);
        }

        .form-textarea {
            resize: vertical;
            min-height: 2.5rem;
        }

        .form-hint {
            font-size: 0.75rem;
            color: var(--gray-500);
            margin-top: 0.25rem;
        }

        .form-actions {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 0.5rem;
            padding-top: 0.5rem;
        }

        @media (min-width: 640px) {
            .form-actions {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }

        .cancel-btn {
            background: var(--gray-200);
            color: var(--gray-800);
            font-weight: 700;
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius-xl);
            border: none;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
        }

        @media (min-width: 640px) {
            .cancel-btn {
                width: auto;
            }
        }

        .cancel-btn:hover {
            background: var(--gray-300);
        }

        .submit-btn {
            background: linear-gradient(to right, var(--green-500), var(--blue-600));
            color: var(--white);
            font-weight: 700;
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            border: none;
            cursor: pointer;
            width: 100%;
        }

        @media (min-width: 640px) {
            .submit-btn {
                width: auto;
            }
        }

        .submit-btn:hover {
            opacity: 0.9;
            box-shadow: var(--shadow-xl);
        }

        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 40;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal-backdrop.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            position: fixed;
            inset: 0;
            background: linear-gradient(to bottom right, var(--green-50), var(--blue-50));
            z-index: 50;
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            overflow-y: auto;
            padding-bottom: 6rem;
        }

        .modal-content.show {
            transform: translateY(0);
        }

        .modal-close {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 60;
            width: 3rem;
            height: 3rem;
            border-radius: 9999px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--gray-200);
            box-shadow: var(--shadow-lg);
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-close:hover {
            background: var(--gray-100);
        }

        .modal-close svg {
            width: 1.5rem;
            height: 1.5rem;
            stroke-width: 2;
        }

        .modal-header-img {
            height: 16rem;
            background: linear-gradient(to right, var(--green-600), var(--blue-700));
            position: relative;
        }

        @media (min-width: 640px) {
            .modal-header-img {
                height: 18rem;
            }
        }

        .modal-profile {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) translateY(50%);
            width: 7rem;
            height: 7rem;
            border-radius: var(--border-radius-2xl);
            overflow: hidden;
            border: 4px solid var(--white);
            box-shadow: var(--shadow-2xl);
            background: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @media (min-width: 640px) {
            .modal-profile {
                width: 8rem;
                height: 8rem;
            }
        }

        .modal-profile img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .modal-body {
            max-width: 48rem;
            margin: 0 auto;
            padding: 0 1rem;
            padding-top: 5rem;
        }

        .modal-title {
            text-align: center;
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-top: 1rem;
            margin-bottom: 1.5rem;
        }

        .modal-badges {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }

        .modal-badge {
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
        }

        .modal-badge svg {
            width: 0.875rem;
            height: 0.875rem;
            stroke-width: 2;
        }

        .modal-section {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(4px);
            border-radius: var(--border-radius-xl);
            padding: 1.25rem;
            margin-bottom: 2rem;
            border: 1px solid var(--green-100);
        }

        .modal-section.yellow {
            border-color: var(--yellow-100);
        }

        .modal-section-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .modal-section-title svg {
            width: 1.25rem;
            height: 1.25rem;
            stroke-width: 2;
        }

        .modal-section-title.green svg {
            color: var(--green-600);
        }

        .modal-section-title.amber svg {
            color: var(--amber-600);
        }

        .modal-section-content {
            color: var(--gray-700);
            line-height: 1.6;
            white-space: pre-line;
        }

        .modal-promo {
            background: linear-gradient(to right, var(--amber-50), var(--amber-100));
            border: 1px solid var(--amber-200);
            border-radius: var(--border-radius-xl);
            padding: 1rem;
            margin-bottom: 2rem;
        }

        .modal-promo-content {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .modal-promo-icon {
            flex-shrink: 0;
            margin-top: 0.25rem;
        }

        .modal-promo-icon svg {
            width: 1.25rem;
            height: 1.25rem;
            color: var(--amber-600);
            stroke-width: 2;
        }

        .modal-promo-text p {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--amber-900);
            margin-bottom: 0.5rem;
        }

        .modal-promo-link {
            display: inline-block;
            background: linear-gradient(to right, var(--amber-500), var(--orange-600));
            color: var(--white);
            font-weight: 700;
            padding: 0.5rem 1rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            font-size: 0.75rem;
            text-decoration: none;
            margin-top: 0.25rem;
        }

        .modal-promo-link:hover {
            opacity: 0.9;
            box-shadow: var(--shadow-md);
        }

        .modal-join-btn {
            background: linear-gradient(to right, var(--green-500), var(--blue-600));
            color: var(--white);
            font-weight: 700;
            padding: 1rem;
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            text-decoration: none;
            display: block;
            text-align: center;
            font-size: 1.125rem;
            margin-bottom: 0.75rem;
        }

        .modal-join-btn:hover {
            opacity: 0.9;
            box-shadow: var(--shadow-xl);
        }

        .modal-join-btn svg {
            width: 1.5rem;
            height: 1.5rem;
            stroke-width: 2;
            margin-right: 0.5rem;
        }

        .modal-join-hint {
            font-size: 0.75rem;
            color: var(--gray-500);
            text-align: center;
            margin-bottom: 2rem;
        }

        .modal-footer {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--gray-200);
            text-align: center;
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        .modal-footer-title {
            font-weight: 700;
            color: var(--green-700);
            margin-bottom: 0.5rem;
        }

        .modal-footer a {
            color: var(--green-700);
            font-weight: 500;
            text-decoration: none;
            transition: var(--transition);
        }

        .modal-footer a:hover {
            color: var(--green-900);
            text-decoration: underline;
        }

        .footer {
            background: linear-gradient(to right, var(--green-700), var(--blue-800));
            color: var(--white);
            padding: 1.5rem;
            margin-top: auto;
        }

        .footer-container {
            max-width: 80rem;
            margin: 0 auto;
            text-align: center;
            padding: 0 1rem;
        }

        .footer-logo {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(4px);
            border-radius: var(--border-radius-xl);
            padding: 0.75rem;
            display: inline-block;
            margin-bottom: 1rem;
            box-shadow: var(--shadow-md);
        }

        .footer-logo svg {
            width: 1.75rem;
            height: 1.75rem;
            stroke-width: 1.5;
        }

        .footer-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .footer-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 1rem;
        }

        .footer-promo {
            margin: 1rem 0;
        }

        .footer-promo-link {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(to right, var(--amber-400), var(--orange-500));
            color: var(--white);
            font-weight: 700;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            font-size: 0.75rem;
            text-decoration: none;
        }

        .footer-promo-link:hover {
            opacity: 0.9;
            box-shadow: var(--shadow-xl);
        }

        .footer-promo-link svg {
            width: 0.875rem;
            height: 0.875rem;
            stroke-width: 2;
            margin-right: 0.5rem;
        }

        .footer-tagline {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            opacity: 0.8;
            margin: 0.75rem 0;
        }

        .footer-tagline svg {
            width: 1.125rem;
            height: 1.125rem;
            stroke-width: 2;
            margin-right: 0.375rem;
        }

        .footer-desc {
            font-size: 0.75rem;
            opacity: 0.75;
            margin: 0.25rem 0;
        }

        .footer-copyright {
            font-size: 0.75rem;
            opacity: 0.75;
            margin-top: 1rem;
        }

        /* Responsive adjustments */
        @media (max-width: 767px) {
            .nav-buttons {
                gap: 0.25rem;
            }
            
            .nav-btn {
                padding: 0.25rem 0.5rem;
                font-size: 0.75rem;
            }
            
            .add-btn {
                padding: 0.25rem 0.75rem;
                font-size: 0.75rem;
            }
            
            .add-btn span {
                display: none;
            }
            
            .logo-text h1 {
                font-size: 1.125rem;
            }
        }

        @media (min-width: 768px) {
            .header-container {
                padding: 0 1.5rem;
            }
            
            .logo-text h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header - Rediseñado para ser más fino y en una sola línea -->
    <header class="header">
        <div class="header-container">
            <div class="logo-container">
                <div class="logo-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                        <circle cx="12" cy="12" r="2" fill="currentColor" />
                    </svg>
                </div>
                <div class="logo-text">
                    <h1>Bandadas.net</h1>
                </div>
            </div>
            
            <div class="nav-buttons">
                <button class="nav-btn active" data-view="home">Inicio</button>
                <button class="add-btn" data-view="add">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
                    </svg>
                    <span>Añadir grupo</span>
                </button>
            </div>
        </div>
    </header>
    
    <!-- Main Content -->
    <main class="main-container">
        <!-- Home View -->
        <div class="view home-view active">
            <!-- Hero Section -->
            <section class="hero">
                <h3>Directorio de Comunidades de Bandadas</h3>
                <p>Conecta con grupos de ornitología y avicultura en España. Explora por categorías, regiones y encuentra tu comunidad perfecta.</p>
                
                <!-- Promotional Banner -->
                <div class="promo-banner">
                    <div class="promo-content">
                        <div class="promo-content-inner">
                            <div class="promo-text">
                                <div class="promo-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                        <polyline points="14 2 14 8 20 8"></polyline>
                                        <line x1="16" y1="13" x2="8" y2="13"></line>
                                        <line x1="16" y1="17" x2="8" y2="17"></line>
                                        <polyline points="10 9 9 9 8 9"></polyline>
                                    </svg>
                                </div>
                                <div class="promo-desc">
                                    <p>¿Eres criador? <span class="hidden-sm">Obtén tu</span> carné federativo y anillas homologadas oficialmente federadas.Federa tus aves online</p>
                                    <p class="text-xs"></p>
                                </div>
                            </div>
                            <a href="https://asociaciontituli.org/federacion" target="_blank" rel="noopener noreferrer" class="promo-link">
                                Federarse
                            </a>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Search Bar -->
            <div class="search-container">
                <div class="search-box">
                    <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="11" cy="11" r="8" />
                        <line x1="21" y1="21" x2="16.65" y2="16.65" />
                    </svg>
                    <input type="text" class="search-input" id="search-input" placeholder="Buscar grupos por nombre, región o categoría...">
                </div>
                <div class="search-result" id="search-result"></div>
            </div>
            
            <!-- Main Categories Carousel -->
            <section>
                <h2 class="section-title green">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                    </svg>
                    Categorías Principales
                </h2>
                <div class="carousel" id="main-categories">
                    <!-- Categories will be inserted here by JavaScript -->
                </div>
            </section>
            
            <!-- Subcategories Carousel -->
            <section id="subcategories-section" style="display: none;">
                <h2 class="section-title blue" id="subcategories-title">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
                    </svg>
                    <span id="subcategory-category-name">Categoría</span> - Subcategorías
                </h2>
                <div class="carousel" id="subcategories">
                    <!-- Subcategories will be inserted here by JavaScript -->
                </div>
            </section>
            
            <!-- Filters Section -->
            <section class="filters-section">
                <div class="filters-container">
                    <div class="filter-group">
                        <label class="green">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            Filtrar por Comunidad Autónoma
                        </label>
                        <select class="filter-select" id="region-filter">
                            <option>Todas</option>
                            <option>Andalucía</option>
                            <option>Aragón</option>
                            <option>Asturias</option>
                            <option>Baleares</option>
                            <option>Canarias</option>
                            <option>Cantabria</option>
                            <option>Castilla-La Mancha</option>
                            <option>Castilla y León</option>
                            <option>Cataluña</option>
                            <option>Comunidad Valenciana</option>
                            <option>Extremadura</option>
                            <option>Galicia</option>
                            <option>Madrid</option>
                            <option>Murcia</option>
                            <option>Navarra</option>
                            <option>País Vasco</option>
                            <option>La Rioja</option>
                            <option>Ceuta</option>
                            <option>Melilla</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="blue">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3 5h12M9 3v2m5.714 2H21M3 11h18M3 17h18M9 9v2m5.714 0H21M9 15v2m5.714 0H21" />
                            </svg>
                            Filtrar por Plataforma
                        </label>
                        <select class="filter-select" id="platform-filter">
                            <option>Todas</option>
                            <option>Telegram</option>
                            <option>WhatsApp</option>
                            <option>Discord</option>
                            <option>Signal</option>
                            <option>Viber</option>
                        </select>
                    </div>
                </div>
            </section>
            
            <!-- Results Info -->
            <div class="results-info" id="results-info">
                Mostrando <span id="results-count">0</span> comunidades
            </div>
            
            <!-- Groups Grid -->
            <div class="groups-grid" id="groups-grid">
                <!-- Groups will be inserted here by JavaScript -->
            </div>
            
            <!-- Empty State (hidden by default) -->
            <div class="empty-state" id="empty-state" style="display: none;">
                <div class="empty-icon">🐦</div>
                <h3 class="empty-title">No se encontraron comunidades</h3>
                <p class="empty-desc" id="empty-desc">No hay comunidades en el directorio todavía</p>
                <button class="empty-btn" id="reset-filters">Ver todas las comunidades</button>
            </div>
            
            <!-- Stats Section -->
            <section class="stats-section">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value green" id="total-communities">0</div>
                        <div class="stat-label">Comunidades</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value blue" id="total-categories">7</div>
                        <div class="stat-label">Categorías</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value yellow" id="total-platforms">5</div>
                        <div class="stat-label">Plataformas</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value rose" id="total-members">0</div>
                        <div class="stat-label">Miembros</div>
                    </div>
                </div>
            </section>
            
            <!-- Association Promo Section -->
            <section class="association-promo">
                <div class="association-content">
                    <div class="association-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path>
                        </svg>
                    </div>
                    <div class="association-text">
                        <h3 class="association-title">¿Eres criador de aves?</h3>
                        <p class="association-desc">Únete a la Asociación Titulí y obtén beneficios exclusivos: carné federativo oficial, anillas numeradas para tus aves, seguros especiales y acceso a concursos oficiales. Todo el proceso 100% online.</p>
                        <div class="association-buttons">
                            <a href="https://asociaciontituli.org/federacion" target="_blank" rel="noopener noreferrer" class="association-btn">
                                Federarse ahora
                            </a>
                            <a href="https://asociaciontituli.org" target="_blank" rel="noopener noreferrer" class="association-link">
                                Más información →
                            </a>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        
        <!-- Add Group View (hidden by default) -->
        <div class="view add-view" style="display: none;">
            <div class="add-header">
                <button class="back-btn" id="back-to-home">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                    </svg>
                </button>
                <h1 class="add-title">Añadir Nueva Comunidad de Aves</h1>
            </div>
            
            <div class="add-card">
                <div class="add-header-bg">
                    <h2 class="add-header-title">Formulario de Registro</h2>
                    <p class="add-header-desc">Completa los datos para añadir tu comunidad al directorio de Bandadas.net</p>
                </div>
                
                <form class="add-form" id="add-group-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="platform">Plataforma *</label>
                            <select class="form-control" id="platform" name="platform" required>
                                <option>Telegram</option>
                                <option>WhatsApp</option>
                                <option>Discord</option>
                                <option>Signal</option>
                                <option>Viber</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="region">Región (Comunidad Autónoma) *</label>
                            <select class="form-control" id="region" name="region" required>
                                <option>Andalucía</option>
                                <option>Aragón</option>
                                <option>Asturias</option>
                                <option>Baleares</option>
                                <option>Canarias</option>
                                <option>Cantabria</option>
                                <option>Castilla-La Mancha</option>
                                <option>Castilla y León</option>
                                <option>Cataluña</option>
                                <option>Comunidad Valenciana</option>
                                <option>Extremadura</option>
                                <option>Galicia</option>
                                <option>Madrid</option>
                                <option>Murcia</option>
                                <option>Navarra</option>
                                <option>País Vasco</option>
                                <option>La Rioja</option>
                                <option>Ceuta</option>
                                <option>Melilla</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="main-category">Categoría Principal *</label>
                        <select class="form-control" id="main-category" name="main-category" required>
                            <option value="cetaceas">Psitácidas</option>
                            <option value="canaricultura">Canaricultura</option>
                            <option value="silvestres">Silvestres</option>
                            <option value="exoticos">Exóticos</option>
                            <option value="avicultura">Avicultura</option>
                            <option value="colombicultura">Colombicultura</option>
                            <option value="ecologia">Ecología</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="sub-category">Subcategoría *</label>
                        <select class="form-control" id="sub-category" name="sub-category" required>
                            <!-- Options will be populated by JavaScript -->
                        </select>
                        <p class="form-hint">Selecciona la subcategoría más específica para tu grupo</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="group-name">Nombre del Grupo *</label>
                        <input type="text" class="form-control" id="group-name" name="group-name" required placeholder="Ej: Criadores de Agapornis Andalucía">
                    </div>
                    
                    <div class="form-group">
                        <label for="group-link">Enlace del Grupo *</label>
                        <input type="url" class="form-control" id="group-link" name="group-link" required placeholder="https://t.me/tu_grupo">
                    </div>
                    
                    <div class="form-group">
                        <label for="group-image">URL de la Imagen (opcional)</label>
                        <input type="url" class="form-control" id="group-image" name="group-image" placeholder="https://ejemplo.com/imagen.jpg">
                        <p class="form-hint">Si no proporcionas imagen, se usará una predeterminada según la categoría</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="group-members">Número de Miembros (opcional)</label>
                        <input type="text" class="form-control" id="group-members" name="group-members" placeholder="Ej: 1.5k">
                    </div>
                    
                    <div class="form-group">
                        <label for="group-description">Descripción Corta *</label>
                        <textarea class="form-control form-textarea" id="group-description" name="group-description" required rows="2" placeholder="Breve descripción que se mostrará en el listado principal..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="group-long-description">Descripción Larga (opcional)</label>
                        <textarea class="form-control form-textarea" id="group-long-description" name="group-long-description" rows="3" placeholder="Describe en detalle el propósito del grupo, actividades, beneficios para los miembros..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="group-rules">Normas del Grupo (opcional)</label>
                        <textarea class="form-control form-textarea" id="group-rules" name="group-rules" rows="3" placeholder="Escribe las normas principales del grupo, una por línea. Ejemplo:
1. Respeto absoluto a las aves
2. Prohibido el comercio ilegal
3. Compartir siempre fuentes..."></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="cancel-btn" id="cancel-add">Cancelar</button>
                        <button type="submit" class="submit-btn">Añadir al Directorio</button>
                    </div>
                </form>
            </div>
        </div>
    </main>
    
    <!-- Group Detail Modal -->
    <div class="modal-backdrop" id="modal-backdrop">
        <div class="modal-content" id="modal-content">
            <button class="modal-close" id="modal-close">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            
            <div class="modal-header-img">
                <div class="modal-profile">
                    <img src="" alt="Grupo" id="modal-profile-img">
                </div>
            </div>
            
            <div class="modal-body">
                <h2 class="modal-title" id="modal-title">Nombre del Grupo</h2>
                
                <div class="modal-badges" id="modal-badges">
                    <!-- Badges will be inserted here by JavaScript -->
                </div>
                
                <div class="modal-section">
                    <h3 class="modal-section-title green">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                        </svg>
                        Sobre esta comunidad
                    </h3>
                    <p class="modal-section-content" id="modal-description"></p>
                </div>
                
                <div class="modal-section yellow" id="modal-rules-section" style="display: none;">
                    <h3 class="modal-section-title amber">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                        </svg>
                        Normas de la comunidad
                    </h3>
                    <p class="modal-section-content" id="modal-rules"></p>
                </div>
                
                <!-- Promotional Banner inside Modal -->
                <div class="modal-promo">
                    <div class="modal-promo-content">
                        <div class="modal-promo-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10 9 9 9 8 9"></polyline>
                            </svg>
                        </div>
                        <div class="modal-promo-text">
                            <p>¿Eres criador de <span id="modal-bird-type">aves</span>? Obtén tu carné federativo y anillas oficiales</p>
                            <a href="https://asociaciontituli.org/federacion" target="_blank" rel="noopener noreferrer" class="modal-promo-link">
                                Federarse con la Asociación Titulí
                            </a>
                        </div>
                    </div>
                </div>
                
                <a href="#" target="_blank" rel="noopener noreferrer" class="modal-join-btn" id="modal-join-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                    </svg>
                    Unirse a la comunidad
                </a>
                <p class="modal-join-hint">Al unirte, aceptas las normas establecidas por los administradores del grupo y comprometes con el bienestar de las aves</p>
                
                <div class="modal-footer">
                    <div class="modal-footer-title">Bandadas.net</div>
                    <p>Dirección: Calle del Pájaro 123, 28001 Madrid</p>
                    <p>Email: contacto@bandadas.net | Tel: +34 912 345 678</p>
                    <p class="mt-2">
                        <a href="https://asociaciontituli.org" target="_blank" rel="noopener noreferrer">
                            Asociación Titulí - Federación de Criadores
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-logo">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                    <circle cx="12" cy="12" r="2" fill="currentColor" />
                </svg>
            </div>
            <p class="footer-title">Bandadas.net</p>
            <p class="footer-subtitle">Grupos de Ornitología y Avicultura • España</p>
            
            <div class="footer-promo">
                <a href="https://asociaciontituli.org/federacion" target="_blank" rel="noopener noreferrer" class="footer-promo-link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Federación Online para Criadores
                </a>
            </div>
            
            <p class="footer-tagline">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                </svg>
                Directorio de comunidades de aves
            </p>
            <p class="footer-desc">Proyecto de la Asociación Titulí para fomentar la ornitología y avicultura responsable</p>
            <p class="footer-copyright">© <span id="current-year"></span> Bandadas.net. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
        // Set current year in footer
        document.getElementById('current-year').textContent = new Date().getFullYear();
        
        // Category tree data
        const categoryTree = {
            todas: {
                name: "Todas las Aves",
                image: "https://placehold.co/150x150/3498db/ffffff?text=Todas+aves",
                subcategories: []
            },
            cetaceas: {
                name: "Psitácidas",
                image: "https://placehold.co/150x150/e74c3c/ffffff?text=🦜+Psitácidas",
                subcategories: [
                    { id: 'agapornis', name: 'Agapornis', image: 'https://placehold.co/100x100/e74c3c/ffffff?text=🦜+Agapornis' },
                    { id: 'periquitos', name: 'Periquitos', image: 'https://placehold.co/100x100/3498db/ffffff?text=🦜+Periquitos' },
                    { id: 'ninfas', name: 'Ninfas', image: 'https://placehold.co/100x100/d35400/ffffff?text=🦜+Ninfas' },
                    { id: 'cacatuas', name: 'Cacatúas', image: 'https://placehold.co/100x100/f39c12/ffffff?text=🦜+Cacatúas' },
                    { id: 'guacamayos', name: 'Guacamayos', image: 'https://placehold.co/100x100/c0392b/ffffff?text=🦜+Guacamayos' },
                    { id: 'amazonas', name: 'Amazonas', image: 'https://placehold.co/100x100/8e44ad/ffffff?text=🦜+Amazonas' }
                ]
            },
            canaricultura: {
                name: "Canaricultura",
                image: "https://placehold.co/150x150/f1c40f/ffffff?text=🐦+Canarios",
                subcategories: [
                    { id: 'canarios', name: 'Canarios', image: 'https://placehold.co/100x100/f1c40f/ffffff?text=🐦+Canarios' },
                    { id: 'jilgueros', name: 'Jilgueros', image: 'https://placehold.co/100x100/d35400/ffffff?text=🐦+Jilgueros' },
                    { id: 'diamantes', name: 'Diamantes', image: 'https://placehold.co/100x100/9b59b6/ffffff?text=🐦+Diamantes' },
                    { id: 'mandarines', name: 'Mandarines', image: 'https://placehold.co/100x100/8e44ad/ffffff?text=🐦+Mandarines' },
                    { id: 'gould', name: 'Gould', image: 'https://placehold.co/100x100/2980b9/ffffff?text=🐦+Gould' }
                ]
            },
            silvestres: {
                name: "Silvestres",
                image: "https://placehold.co/150x150/27ae60/ffffff?text=🦅+Silvestres",
                subcategories: [
                    { id: 'rapaces', name: 'Rapaces', image: 'https://placehold.co/100x100/2c3e50/ffffff?text=🦅+Rapaces' },
                    { id: 'paseriformes', name: 'Paseriformes', image: 'https://placehold.co/100x100/27ae60/ffffff?text=🐦+Paseriformes' },
                    { id: 'acuaticas', name: 'Acuáticas', image: 'https://placehold.co/100x100/1abc9c/ffffff?text=🦆+Acuáticas' },
                    { id: 'migratorias', name: 'Migratorias', image: 'https://placehold.co/100x100/2980b9/ffffff?text=✈️+Migratorias' }
                ]
            },
            exoticos: {
                name: "Exóticos",
                image: "https://placehold.co/150x150/e67e22/ffffff?text=🦜+Exóticos",
                subcategories: [
                    { id: 'loros', name: 'Loros', image: 'https://placehold.co/100x100/e67e22/ffffff?text=🦜+Loros' },
                    { id: 'papagayos', name: 'Papagayos', image: 'https://placehold.co/100x100/c0392b/ffffff?text=🦜+Papagayos' },
                    { id: 'tucanes', name: 'Tucanes', image: 'https://placehold.co/100x100/f39c12/ffffff?text=🐦+Tucanes' },
                    { id: 'aves_paraiso', name: 'Aves del Paraíso', image: 'https://placehold.co/100x100/8e44ad/ffffff?text=🌈+Paraíso' }
                ]
            },
            avicultura: {
                name: "Avicultura",
                image: "https://placehold.co/150x150/16a085/ffffff?text=🐔+Avicultura",
                subcategories: [
                    { id: 'gallinas', name: 'Gallinas', image: 'https://placehold.co/100x100/16a085/ffffff?text=🐔+Gallinas' },
                    { id: 'patos', name: 'Patos', image: 'https://placehold.co/100x100/2980b9/ffffff?text=🦆+Patos' },
                    { id: 'pavos', name: 'Pavos', image: 'https://placehold.co/100x100/8c7b6b/ffffff?text=🦃+Pavos' },
                    { id: 'faisanes', name: 'Faisanes', image: 'https://placehold.co/100x100/d35400/ffffff?text=🦚+Faisanes' }
                ]
            },
            colombicultura: {
                name: "Colombicultura",
                image: "https://placehold.co/150x150/7f8c8d/ffffff?text=🕊️+Palomas",
                subcategories: [
                    { id: 'mensajeras', name: 'Mensajeras', image: 'https://placehold.co/100x100/7f8c8d/ffffff?text=🕊️+Mensajeras' },
                    { id: 'buzos', name: 'Buzos', image: 'https://placehold.co/100x100/95a5a6/ffffff?text=🐦+Buzos' },
                    { id: 'volatineras', name: 'Volatineras', image: 'https://placehold.co/100x100/34495e/ffffff?text=🕊️+Volatineras' },
                    { id: 'exposicion', name: 'Exposición', image: 'https://placehold.co/100x100/2c3e50/ffffff?text=🏆+Exposición' }
                ]
            },
            ecologia: {
                name: "Ecología",
                image: "https://placehold.co/150x150/27ae60/ffffff?text=🌿+Ecología",
                subcategories: [
                    { id: 'conservacion', name: 'Conservación', image: 'https://placehold.co/100x100/27ae60/ffffff?text=🌿+Conservación' },
                    { id: 'habitat', name: 'Hábitat', image: 'https://placehold.co/100x100/2ecc71/ffffff?text=🌳+Hábitat' },
                    { id: 'alimentacion', name: 'Alimentación', image: 'https://placehold.co/100x100/f39c12/ffffff?text=🌾+Alimentación' },
                    { id: 'cria_responsable', name: 'Cría Responsable', image: 'https://placehold.co/100x100/1abc9c/ffffff?text=🐣+Cría' }
                ]
            }
        };
        
        // Spain regions
        const spainRegions = [
            "Todas",
            "Andalucía",
            "Aragón",
            "Asturias",
            "Baleares",
            "Canarias",
            "Cantabria",
            "Castilla-La Mancha",
            "Castilla y León",
            "Cataluña",
            "Comunidad Valenciana",
            "Extremadura",
            "Galicia",
            "Madrid",
            "Murcia",
            "Navarra",
            "País Vasco",
            "La Rioja",
            "Ceuta",
            "Melilla"
        ];
        
        // Platforms
        const platforms = [
            "Todas",
            "Telegram",
            "WhatsApp",
            "Discord",
            "Signal",
            "Viber"
        ];
        
        // Platform colors
        const platformColors = {
            "Telegram": "#0088cc",
            "WhatsApp": "#25D366",
            "Discord": "#5865F2",
            "Signal": "#3a76f0",
            "Viber": "#7360f2"
        };
        
        // Platform class names
        const platformClasses = {
            "Telegram": "telegram",
            "WhatsApp": "whatsapp",
            "Discord": "discord",
            "Signal": "signal",
            "Viber": "viber"
        };
        
        // Generate initial groups
        function createInitialGroups() {
            const groups = [];
            let idCounter = 1;
            const platformsList = ["Telegram", "WhatsApp", "Discord", "Signal", "Viber"];
            
            // Skip "todas" category
            Object.entries(categoryTree).forEach(([mainCatId, mainCatData]) => {
                if (mainCatId === 'todas') return;
                
                mainCatData.subcategories.forEach((subcat, subcatIndex) => {
                    // Create 3 groups per subcategory
                    for (let i = 0; i < 3; i++) {
                        const platform = platformsList[(subcatIndex + i) % platformsList.length];
                        const regionIndex = (subcatIndex + i) % spainRegions.length;
                        const region = spainRegions[regionIndex === 0 ? 1 : regionIndex]; // Avoid "Todas"
                        const members = `${Math.floor(Math.random() * 5) + 1}.${Math.floor(Math.random() * 9)}k`;
                        
                        groups.push({
                            id: idCounter++,
                            platform: platform,
                            name: `${subcat.name} ${region}`,
                            link: `https://${platform.toLowerCase()}.com/${mainCatId}_${subcat.id}_${i}`,
                            description: `Comunidad activa de ${subcat.name.toLowerCase()} en ${region}. Compartimos experiencias, consejos y organizamos eventos.`,
                            longDescription: `¡Bienvenidos a la comunidad de ${subcat.name} ${region}!
Aquí encontrarás:
- Consejos especializados de criadores experimentados
- Solución de problemas de salud y comportamiento
- Intercambio de experiencias y buenas prácticas
- Recomendaciones de veterinarios especializados
- Organización de quedadas y exposiciones regionales
- Alertas sobre enfermedades y cuidados específicos`,
                            rules: `1. Respeto absoluto a todas las aves y criadores
2. Prohibido el comercio ilegal de especies
3. Compartir siempre fuentes de información verificadas
4. No difundir rumores sin contrastar
5. Mantener un ambiente de ayuda mutua y colaboración`,
                            members: members,
                            mainCategory: mainCatId,
                            subCategory: subcat.id,
                            image: subcat.image,
                            region: region,
                            country: "España"
                        });
                    }
                });
            });
            
            return groups;
        }
        
        // State variables
        let state = {
            view: 'home',
            selectedMainCategory: 'todas',
            selectedSubCategory: null,
            selectedPlatform: 'Todas',
            selectedRegion: 'Todas',
            selectedCountry: 'ES',
            searchTerm: '',
            selectedGroup: null,
            groups: createInitialGroups()
        };
        
        // DOM Elements
        const mainCategoriesContainer = document.getElementById('main-categories');
        const subcategoriesContainer = document.getElementById('subcategories');
        const subcategoriesSection = document.getElementById('subcategories-section');
        const subcategoriesTitle = document.getElementById('subcategories-title');
        const subcategoryCategoryName = document.getElementById('subcategory-category-name');
        const regionFilter = document.getElementById('region-filter');
        const platformFilter = document.getElementById('platform-filter');
        const searchInput = document.getElementById('search-input');
        const searchResult = document.getElementById('search-result');
        const resultsInfo = document.getElementById('results-info');
        const resultsCount = document.getElementById('results-count');
        const groupsGrid = document.getElementById('groups-grid');
        const emptyState = document.getElementById('empty-state');
        const emptyDesc = document.getElementById('empty-desc');
        const resetFiltersBtn = document.getElementById('reset-filters');
        const totalCommunitiesEl = document.getElementById('total-communities');
        const totalMembersEl = document.getElementById('total-members');
        const navBtns = document.querySelectorAll('.nav-btn');
        const addBtns = document.querySelectorAll('[data-view="add"]');
        const homeView = document.querySelector('.home-view');
        const addView = document.querySelector('.add-view');
        const backToHomeBtn = document.getElementById('back-to-home');
        const cancelAddBtn = document.getElementById('cancel-add');
        const addGroupForm = document.getElementById('add-group-form');
        const mainCategorySelect = document.getElementById('main-category');
        const subCategorySelect = document.getElementById('sub-category');
        const modalBackdrop = document.getElementById('modal-backdrop');
        const modalContent = document.getElementById('modal-content');
        const modalCloseBtn = document.getElementById('modal-close');
        const modalProfileImg = document.getElementById('modal-profile-img');
        const modalTitle = document.getElementById('modal-title');
        const modalBadges = document.getElementById('modal-badges');
        modalBadges.innerHTML = ''; // Clear initial content
        const modalDescription = document.getElementById('modal-description');
        const modalRulesSection = document.getElementById('modal-rules-section');
        const modalRules = document.getElementById('modal-rules');
        const modalBirdType = document.getElementById('modal-bird-type');
        const modalJoinBtn = document.getElementById('modal-join-btn');
        const currentYearEl = document.getElementById('current-year');
        
        // Initialize the app
        function init() {
            // Set current year
            currentYearEl.textContent = new Date().getFullYear();
            
            // Render main categories
            renderMainCategories();
            
            // Render groups
            renderGroups();
            
            // Update stats
            updateStats();
            
            // Event listeners
            setupEventListeners();
            
            // Initialize subcategories for the default main category
            updateSubcategories();
        }
        
        // Render main categories carousel
        function renderMainCategories() {
            mainCategoriesContainer.innerHTML = '';
            
            Object.entries(categoryTree).forEach(([categoryId, category]) => {
                const isActive = state.selectedMainCategory === categoryId;
                
                const categoryEl = document.createElement('div');
                categoryEl.className = 'carousel-item';
                categoryEl.innerHTML = `
                    <button class="category-btn ${isActive ? 'active' : ''}" data-category="${categoryId}">
                        <div class="category-img">
                            <img src="${category.image}" alt="${category.name}" onerror="this.src='https://placehold.co/150x150/9ca3af/ffffff?text=Error'">
                        </div>
                        <span class="category-name">${category.name}</span>
                    </button>
                `;
                
                mainCategoriesContainer.appendChild(categoryEl);
            });
        }
        
        // Update subcategories based on selected main category
        function updateSubcategories() {
            if (state.selectedMainCategory === 'todas') {
                subcategoriesSection.style.display = 'none';
                return;
            }
            
            subcategoriesSection.style.display = 'block';
            subcategoryCategoryName.textContent = categoryTree[state.selectedMainCategory].name;
            
            const subcategories = categoryTree[state.selectedMainCategory].subcategories;
            subcategoriesContainer.innerHTML = '';
            
            subcategories.forEach(subcat => {
                const isActive = state.selectedSubCategory === subcat.id;
                
                const subcatEl = document.createElement('div');
                subcatEl.className = 'carousel-item';
                subcatEl.innerHTML = `
                    <button class="category-btn ${isActive ? 'active' : ''}" data-subcategory="${subcat.id}">
                        <div class="category-img">
                            <img src="${subcat.image}" alt="${subcat.name}" onerror="this.src='https://placehold.co/150x150/9ca3af/ffffff?text=Error'">
                        </div>
                        <span class="category-name">${subcat.name}</span>
                    </button>
                `;
                
                subcategoriesContainer.appendChild(subcatEl);
            });
        }
        
        // Parse member count string to number
        function parseMemberCount(membersStr) {
            if (typeof membersStr !== 'string') return 0;
            if (membersStr.includes('k')) {
                const num = parseFloat(membersStr.replace('k', ''));
                return isNaN(num) ? 0 : num * 1000;
            }
            return parseInt(membersStr) || 0;
        }
        
        // Calculate total members
        function calculateTotalMembers() {
            return state.groups.reduce((total, group) => 
                total + parseMemberCount(group.members), 0
            );
        }
        
        // Update stats display
        function updateStats() {
            totalCommunitiesEl.textContent = state.groups.length;
            totalMembersEl.textContent = calculateTotalMembers().toLocaleString('es-ES');
        }
        
        // Filter groups based on current state
        function filterGroups() {
            return state.groups.filter(group => {
                // Country filter (simplified for this implementation)
                if (state.selectedCountry !== 'ES' && group.country !== state.selectedCountry) {
                    return false;
                }
                
                // Platform filter
                const platformMatch = state.selectedPlatform === 'Todas' || group.platform === state.selectedPlatform;
                
                // Region filter
                const regionMatch = state.selectedRegion === 'Todas' || group.region === state.selectedRegion;
                
                // Category filters
                if (state.selectedMainCategory === 'todas') {
                    return platformMatch && regionMatch;
                }
                
                const mainCategoryMatch = group.mainCategory === state.selectedMainCategory;
                
                if (state.selectedSubCategory) {
                    return platformMatch && regionMatch && mainCategoryMatch && group.subCategory === state.selectedSubCategory;
                }
                
                // Search filter
                const searchMatch = state.searchTerm === '' ||
                    group.name.toLowerCase().includes(state.searchTerm.toLowerCase()) ||
                    group.description.toLowerCase().includes(state.searchTerm.toLowerCase()) ||
                    group.region.toLowerCase().includes(state.searchTerm.toLowerCase()) ||
                    categoryTree[group.mainCategory].name.toLowerCase().includes(state.searchTerm.toLowerCase()) ||
                    categoryTree[group.mainCategory].subcategories
                        .find(s => s.id === group.subCategory)?.name
                        .toLowerCase()
                        .includes(state.searchTerm.toLowerCase());
                
                return platformMatch && regionMatch && mainCategoryMatch && searchMatch;
            });
        }
        
        // Render groups grid
        function renderGroups() {
            const filteredGroups = filterGroups();
            resultsCount.textContent = filteredGroups.length;
            
            // Update results info text
            let infoText = `Mostrando <span class="text-green-600 font-bold">${filteredGroups.length}</span> comunidades`;
            
            if (state.selectedMainCategory !== 'todas') {
                infoText += ` en ${categoryTree[state.selectedMainCategory].name}`;
            }
            
            if (state.selectedSubCategory) {
                const subcat = categoryTree[state.selectedMainCategory].subcategories
                    .find(s => s.id === state.selectedSubCategory);
                if (subcat) infoText += ` - ${subcat.name}`;
            }
            
            if (state.selectedRegion !== 'Todas') {
                infoText += ` en ${state.selectedRegion}`;
            }
            
            if (state.selectedPlatform !== 'Todas') {
                infoText += ` para ${state.selectedPlatform}`;
            }
            
            resultsInfo.innerHTML = infoText;
            
            // Show/hide empty state
            if (filteredGroups.length === 0) {
                emptyState.style.display = 'block';
                
                if (state.selectedSubCategory) {
                    const subcat = categoryTree[state.selectedMainCategory].subcategories
                        .find(s => s.id === state.selectedSubCategory);
                    emptyDesc.textContent = `No hay comunidades para ${subcat.name} en este momento`;
                } else if (state.selectedMainCategory !== 'todas') {
                    emptyDesc.textContent = `No hay comunidades para ${categoryTree[state.selectedMainCategory].name} en este momento`;
                } else {
                    emptyDesc.textContent = 'No hay comunidades en el directorio todavía';
                }
                
                groupsGrid.style.display = 'none';
            } else {
                emptyState.style.display = 'none';
                groupsGrid.style.display = 'grid';
                
                groupsGrid.innerHTML = '';
                
                filteredGroups.forEach(group => {
                    const category = categoryTree[group.mainCategory];
                    const subcategory = category.subcategories.find(s => s.id === group.subCategory);
                    
                    const groupCard = document.createElement('div');
                    groupCard.className = 'group-card';
                    groupCard.innerHTML = `
                        <div class="group-content">
                            <div class="group-info">
                                <div class="group-img">
                                    <img src="${group.image}" alt="${group.name}" onerror="this.src='https://placehold.co/100x100/${platformColors[group.platform].replace('#', '')}/ffffff?text=${group.subCategory.charAt(0)}'">
                                </div>
                                <div class="group-details">
                                    <div class="group-badges">
                                        <span class="badge platform ${platformClasses[group.platform]}">${group.platform}</span>
                                        <span class="badge members">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                            </svg>
                                            ${group.members} miembros
                                        </span>
                                        <span class="badge category">${category.name}</span>
                                        <span class="badge subcategory">${subcategory.name}</span>
                                        <span class="badge region">${group.region}</span>
                                    </div>
                                    <h3 class="group-name">
                                        <button class="group-name-btn" data-group-id="${group.id}">
                                            ${group.name}
                                        </button>
                                    </h3>
                                    <p class="group-desc">${group.description}</p>
                                </div>
                            </div>
                            <button class="group-btn" data-group-id="${group.id}">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                                </svg>
                                Ver detalles
                            </button>
                        </div>
                    `;
                    
                    groupsGrid.appendChild(groupCard);
                });
            }
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Category buttons
            mainCategoriesContainer.addEventListener('click', (e) => {
                if (e.target.closest('.category-btn')) {
                    const categoryId = e.target.closest('.category-btn').dataset.category;
                    handleMainCategoryClick(categoryId);
                }
            });
            
            // Subcategory buttons
            subcategoriesContainer.addEventListener('click', (e) => {
                if (e.target.closest('.category-btn')) {
                    const subcategoryId = e.target.closest('.category-btn').dataset.subcategory;
                    handleSubCategoryClick(subcategoryId);
                }
            });
            
            // Filter changes
            regionFilter.addEventListener('change', (e) => {
                state.selectedRegion = e.target.value;
                renderGroups();
            });
            
            platformFilter.addEventListener('change', (e) => {
                state.selectedPlatform = e.target.value;
                renderGroups();
            });
            
            // Search input
            searchInput.addEventListener('input', (e) => {
                state.searchTerm = e.target.value;
                
                if (state.searchTerm) {
                    searchResult.innerHTML = `Mostrando resultados para: <span class="font-medium text-green-600">"${state.searchTerm}"</span>`;
                } else {
                    searchResult.innerHTML = '';
                }
                
                renderGroups();
            });
            
            // Reset filters button
            resetFiltersBtn.addEventListener('click', () => {
                state.selectedMainCategory = 'todas';
                state.selectedSubCategory = null;
                state.selectedPlatform = 'Todas';
                state.selectedRegion = 'Todas';
                state.searchTerm = '';
                searchInput.value = '';
                searchResult.innerHTML = '';
                regionFilter.value = 'Todas';
                platformFilter.value = 'Todas';
                
                renderMainCategories();
                updateSubcategories();
                renderGroups();
            });
            
            // Navigation buttons
            navBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    if (btn.dataset.view === 'home') {
                        setView('home');
                    }
                });
            });
            
            // Add buttons
            addBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    setView('add');
                });
            });
            
            // Back to home buttons
            backToHomeBtn.addEventListener('click', () => {
                setView('home');
            });
            
            cancelAddBtn.addEventListener('click', () => {
                setView('home');
            });
            
            // Add group form
            addGroupForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const platform = document.getElementById('platform').value;
                const region = document.getElementById('region').value;
                const mainCategory = document.getElementById('main-category').value;
                const subCategory = document.getElementById('sub-category').value;
                const name = document.getElementById('group-name').value.trim();
                const link = document.getElementById('group-link').value.trim();
                const image = document.getElementById('group-image').value.trim() || 
                    categoryTree[mainCategory].subcategories.find(s => s.id === subCategory).image;
                const members = document.getElementById('group-members').value.trim() || "0";
                const description = document.getElementById('group-description').value.trim();
                const longDescription = document.getElementById('group-long-description').value.trim();
                const rules = document.getElementById('group-rules').value.trim();
                
                if (!name || !link) {
                    alert("Por favor completa el nombre y el enlace del grupo");
                    return;
                }
                
                const newGroup = {
                    id: Date.now(),
                    platform,
                    name,
                    link,
                    description,
                    longDescription,
                    rules,
                    members,
                    mainCategory,
                    subCategory,
                    image,
                    region,
                    country: "España"
                };
                
                state.groups.unshift(newGroup);
                setView('home');
                
                // Reset form
                addGroupForm.reset();
                document.getElementById('region').value = 'Madrid';
                document.getElementById('main-category').value = 'cetaceas';
                updateSubcategoriesDropdown('cetaceas');
                
                // Reset filters and search
                state.selectedMainCategory = 'todas';
                state.selectedSubCategory = null;
                state.selectedPlatform = 'Todas';
                state.selectedRegion = 'Todas';
                state.searchTerm = '';
                searchInput.value = '';
                searchResult.innerHTML = '';
                regionFilter.value = 'Todas';
                platformFilter.value = 'Todas';
                
                // Re-render
                renderMainCategories();
                updateSubcategories();
                renderGroups();
                updateStats();
            });
            
            // Main category change in form
            mainCategorySelect.addEventListener('change', (e) => {
                updateSubcategoriesDropdown(e.target.value);
            });
            
            // Group click handlers (for group name and details button)
            groupsGrid.addEventListener('click', (e) => {
                if (e.target.closest('.group-name-btn') || e.target.closest('.group-btn')) {
                    const groupId = e.target.closest('[data-group-id]').dataset.groupId;
                    const group = state.groups.find(g => g.id == groupId);
                    if (group) {
                        showGroupModal(group);
                    }
                }
            });
            
            // Modal close button
            modalCloseBtn.addEventListener('click', closeModal);
            
            // Modal backdrop click
            modalBackdrop.addEventListener('click', (e) => {
                if (e.target === modalBackdrop) {
                    closeModal();
                }
            });
            
            // Escape key to close modal
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && state.selectedGroup) {
                    closeModal();
                }
            });
        }
        
        // Handle main category click
        function handleMainCategoryClick(categoryId) {
            state.selectedMainCategory = categoryId;
            state.selectedSubCategory = null;
            
            // Update UI
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.querySelector(`.category-btn[data-category="${categoryId}"]`).classList.add('active');
            
            // Update subcategories
            updateSubcategories();
            
            // Re-render groups
            renderGroups();
        }
        
        // Handle subcategory click
        function handleSubCategoryClick(subcategoryId) {
            state.selectedSubCategory = state.selectedSubCategory === subcategoryId ? null : subcategoryId;
            
            // Update UI
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (state.selectedSubCategory) {
                document.querySelector(`.category-btn[data-subcategory="${subcategoryId}"]`).classList.add('active');
            }
            
            // Re-render groups
            renderGroups();
        }
        
        // Set view (home or add)
        function setView(viewName) {
            state.view = viewName;
            
            // Update navigation UI
            if (viewName === 'home') {
                homeView.classList.add('active');
                homeView.style.display = 'block';
                addView.style.display = 'none';
                
                // Update nav buttons
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    if (btn.dataset.view === 'home') {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
            } else {
                homeView.classList.remove('active');
                homeView.style.display = 'none';
                addView.style.display = 'block';
                
                // Update nav buttons
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
            }
        }
        
        // Update subcategories dropdown in form
        function updateSubcategoriesDropdown(mainCategoryId) {
            const subcategories = categoryTree[mainCategoryId].subcategories;
            subCategorySelect.innerHTML = '';
            
            subcategories.forEach(subcat => {
                const option = document.createElement('option');
                option.value = subcat.id;
                option.textContent = subcat.name;
                subCategorySelect.appendChild(option);
            });
        }
        
        // Show group modal
        function showGroupModal(group) {
            state.selectedGroup = group;
            
            // Set modal content
            modalProfileImg.src = group.image;
            modalProfileImg.onerror = () => {
                modalProfileImg.src = `https://placehold.co/100x100/${platformColors[group.platform].replace('#', '')}/ffffff?text=${group.subCategory.charAt(0)}`;
            };
            
            modalTitle.textContent = group.name;
            
            // Set badges
            const category = categoryTree[group.mainCategory];
            const subcategory = category.subcategories.find(s => s.id === group.subCategory);
            
            modalBadges.innerHTML = `
                <span class="modal-badge" style="background-color: ${platformColors[group.platform]}; color: white;">
                    ${group.platform}
                </span>
                <span class="modal-badge">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                    </svg>
                    ${group.members} miembros
                </span>
                <span class="modal-badge" style="background-color: #22c55e; color: white;">
                    ${category.name}
                </span>
                <span class="modal-badge" style="background-color: #3b82f6; color: white;">
                    ${subcategory.name}
                </span>
                <span class="modal-badge" style="background-color: #f59e0b; color: white;">
                    ${group.region}
                </span>
            `;
            
            // Set description
            modalDescription.textContent = group.longDescription || group.description;
            
            // Set rules
            if (group.rules) {
                modalRulesSection.style.display = 'block';
                modalRules.textContent = group.rules;
            } else {
                modalRulesSection.style.display = 'none';
            }
            
            // Set bird type for promo
            modalBirdType.textContent = subcategory.name.toLowerCase();
            
            // Set join button
            modalJoinBtn.href = group.link;
            
            // Show modal
            modalBackdrop.classList.add('show');
            setTimeout(() => {
                modalContent.classList.add('show');
            }, 10);
            
            // Prevent scrolling
            document.body.style.overflow = 'hidden';
        }
        
        // Close modal
        function closeModal() {
            state.selectedGroup = null;
            
            // Hide modal
            modalContent.classList.remove('show');
            setTimeout(() => {
                modalBackdrop.classList.remove('show');
            }, 300);
            
            // Restore scrolling
            document.body.style.overflow = '';
        }
        
        // Initialize the app when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>

